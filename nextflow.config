params {
    out_dir = './output'
    report_dir = './reports'
    custom_config_version       = 'master'
    custom_config_base          = "https://raw.githubusercontent.com/nf-core/configs/${params.custom_config_version}"
}

profiles {

  conda { 
    conda.enabled = true
    process.conda = "$baseDir/environment.yaml" 
  }

  docker { 
    docker.enabled = true
    process.container = 'haniffalab/webatlas-pipeline:0.3.2'
  }
  
  singularity { 
    singularity.enabled = false
    singularity.autoMounts = false
  }

process {

    errorStrategy = { task.exitStatus in [130,137..140] ? 'retry' : 'terminate' }
    maxRetries = 5

    withLabel: small {
        cpus = 1
        memory = { 2.GB * task.attempt }
    }
    withLabel: large {
        cpus = { 4 * task.attempt }
        memory = { 10.GB * task.attempt }
    }
}