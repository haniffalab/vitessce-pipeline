<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration &mdash; WebAtlas 0.3.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=53a30eae"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running" href="run.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            WebAtlas
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#environment-setup">Environment setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parameters-file">Parameters file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#project">Project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataset">Dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#args">Args</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vitessce-options">Vitessce options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="run.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualise.html">Visualising</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cellatlas.io/webatlas">Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Workflows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/visium.html">Visium</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/xenium.html">Xenium</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/haniffalab/webatlas-pipeline">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/haniffalab/webatlas-pipeline/issues">Issue Tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/haniffalab/webatlas-app">WebAtlas App</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Teams</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.sanger.ac.uk/group/bayraktar-group">Bayraktar Lab</a></li>
<li class="toctree-l1"><a class="reference external" href="https://haniffalab.com">Haniffa Lab</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.openmicroscopy.org/">Open Microscopy Environment</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WebAtlas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/configuration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration">
<span id="id1"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h1>
<p>Currently, the WebAtlas pipeline can process several types of data files as well as images.</p>
<p><strong>Data files</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://anndata.readthedocs.io/en/latest/">AnnData</a> files (<code class="docutils literal notranslate"><span class="pre">h5ad</span></code>)</p></li>
<li><p><a class="reference external" href="https://support.10xgenomics.com/spatial-gene-expression/software/pipelines/latest/output/overview">SpaceRanger output</a> files</p></li>
<li><p><a class="reference external" href="https://www.10xgenomics.com/support/in-situ-gene-expression/documentation/steps/onboard-analysis/understanding-xenium-outputs">Xenium output</a> files</p></li>
<li><p>MERSCOPE output</p></li>
<li><p>molecules data in <code class="docutils literal notranslate"><span class="pre">csv</span></code>/<code class="docutils literal notranslate"><span class="pre">tsv</span></code> files</p></li>
</ul>
<p><strong>Image files</strong></p>
<ul class="simple">
<li><p>raw and label images in <a class="reference external" href="https://en.wikipedia.org/wiki/TIFF">tif format</a></p></li>
<li><p>images from <a class="reference external" href="https://www.10xgenomics.com/support/spatial-gene-expression-fresh-frozen/documentation/steps/imaging/visium-spatial-gene-expression-imaging-guidelines">Visium</a></p></li>
<li><p>imags from <a class="reference external" href="https://www.10xgenomics.com/support/in-situ-gene-expression/documentation/steps/onboard-analysis/xenium-algorithms-overview#dapi">Xenium</a></p></li>
<li><p>MERFISH data</p></li>
</ul>
<p>Running the pipeline requires a YAML parameters file that lists the data to be processed. Templates of this parameters file are available in the <a class="reference external" href="https://github.com/haniffalab/webatlas-pipeline/tree/main/templates/">templates directory</a>.</p>
<section id="parameters-file">
<span id="id2"></span><h2>Parameters file<a class="headerlink" href="#parameters-file" title="Permalink to this heading"></a></h2>
<p>The parameters file defines several configuration options which apply to a full run of the pipeline (which can process one or more datasets). When running the pipeline, the path to the YAML file is indicated through the <code class="docutils literal notranslate"><span class="pre">-params-file</span></code> flag in the command line. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>nextflow<span class="w"> </span>run<span class="w"> </span>main.nf<span class="w"> </span>-params-file<span class="w"> </span>params.yaml
</pre></div>
</div>
<p>A parameters file looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">outdir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/output/&quot;</span>

<span class="nt">args</span><span class="p">:</span>
<span class="w">  </span><span class="nt">h5ad</span><span class="p">:</span>
<span class="w">    </span><span class="nt">compute_embeddings</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span>

<span class="nt">projects</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">project_1</span>
<span class="w">    </span><span class="nt">datasets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataset_1</span>
<span class="w">        </span><span class="nt">data</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h5ad</span>
<span class="w">            </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/anndata.h5ad</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">raw_image</span>
<span class="w">            </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/raw_image.tif</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">label_image</span>
<span class="w">            </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/label_image.tif</span>

<span class="nt">vitessce_options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">    </span><span class="nt">xy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;obsm/spatial&quot;</span>
<span class="w">  </span><span class="nt">mappings</span><span class="p">:</span>
<span class="w">    </span><span class="nt">obsm/X_umap</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">]</span>
<span class="nt">layout</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;simple&quot;</span>
<span class="c1"># custom_layout: &quot;spatial|scatterplot&quot; # overrides `layout`</span>
</pre></div>
</div>
<p>The YAML file has multiple configuration segements. This is a simple breakdown of the example config file above:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">outdir</span></code> entry in the file tells the pipeline where to deposit the result files.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">outdir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/output/&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">args.h5ad.compute_embeddings:</span> <span class="pre">&quot;True&quot;</span></code> instructs the pipeline to compute dimensional reduction on the input Anndata and store the PCA and UMAP embeddings inside the obsm keys of the oject.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">args</span><span class="p">:</span>
<span class="w">  </span><span class="nt">h5ad</span><span class="p">:</span>
<span class="w">    </span><span class="nt">compute_embeddings</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">projects</span></code> section defines the name of the current <a class="reference internal" href="#project">project</a> and the <code class="docutils literal notranslate"><span class="pre">datasets</span></code> that are part of it.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">projects</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">project_1</span>
<span class="w">    </span><span class="nt">datasets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataset_1</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Each <a class="reference internal" href="#dataset">dataset</a> has name (ie. dataset_1) and is a collection of <a class="reference internal" href="#data">data</a> objects each one containing a type and a path. The path (<code class="docutils literal notranslate"><span class="pre">data_path</span></code>) points to the file that should be processed. The type (<code class="docutils literal notranslate"><span class="pre">data_type</span></code>) specifies what the input file is and how the file will be processed.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataset_1</span>
<span class="w">  </span><span class="nt">data</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h5ad</span>
<span class="w">      </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/anndata.h5ad</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">raw_image</span>
<span class="w">      </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/raw_image.tif</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">label_image</span>
<span class="w">      </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/label_image.tif</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The final <code class="docutils literal notranslate"><span class="pre">vitessce_options</span></code> section helps configure properties to map the processed that to visual compoentents. For exmaple for Spatial data where the embedings are stored inside the object. For mappings, it tells the embedings to use and the range to map the values to (in this case from 0..1).</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vitessce_options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">    </span><span class="nt">xy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;obsm/spatial&quot;</span>
<span class="w">  </span><span class="nt">mappings</span><span class="p">:</span>
<span class="w">    </span><span class="nt">obsm/X_umap</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div></blockquote>
<p>The more detailed list of parameters is as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">outdir</span></code></p></td>
<td><p>the path to the directory to which output files will be written.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p></td>
<td><p>a map of optional arguments per data type for the scripts that process them.</p>
<p>These serve as the default values for all projects.</p>
<p>See <a class="reference internal" href="#args">args</a>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">projects</span></code></p></td>
<td><p>a list of projects where each contain a list of datasets that hold one or more
data files to process.</p>
<p>See <a class="reference internal" href="#project">project</a>.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vitessce_options</span></code></p></td>
<td><p>a map of the contents of an input Anndata object
to be shown in the Vitessce visualization.</p>
<p>These values serve as the default for all projects.</p>
<p>See <a class="reference internal" href="#vitessce-options">vitessce_options</a>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">layout</span></code></p></td>
<td><p>a predefined Vitessce layout to use, it can be either
<code class="docutils literal notranslate"><span class="pre">minimal</span></code>, <code class="docutils literal notranslate"><span class="pre">simple</span></code> or <code class="docutils literal notranslate"><span class="pre">advanced</span></code>.</p>
<p>This value serves as the default for all projects.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">custom_layout</span></code></p></td>
<td><p><cite>optional</cite> string that defines a Vitessce layout
following <a class="reference external" href="https://vitessce.github.io/vitessce-python/api_config.html#vitessce.config.VitessceConfig.layout">Vitessce’s View Config API’s layout alternative
syntax</a>
(Vitessce components are concatenated horizontally with <code class="docutils literal notranslate"><span class="pre">|</span></code> and
vertically with <code class="docutils literal notranslate"><span class="pre">/</span></code>).</p>
<p>Supersedes <code class="docutils literal notranslate"><span class="pre">layout</span></code>.</p>
<p>This value serves as the default for all projects.</p>
</td>
</tr>
</tbody>
</table>
<section id="project">
<span id="id3"></span><h3>Project<a class="headerlink" href="#project" title="Permalink to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">projects</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">project_1</span>
<span class="w">    </span><span class="nt">datasets</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span>
<span class="w">      </span><span class="nt">h5ad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">batch_processing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>Multiple projects can be defined in a single parameters file, and each can define multiple datasets.
Each project item is defined by the following keys:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">project</span></code></p></td>
<td><p>a unique project name/id</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">datasets</span></code></p></td>
<td><p>a list of dataset items.</p>
<p>See <a class="reference internal" href="#dataset">dataset</a>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p></td>
<td><p><cite>optional</cite> map of arguments per data type to set as default for all files within the project.</p>
<p>Supersedes global <code class="docutils literal notranslate"><span class="pre">args</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<section id="dataset">
<span id="id4"></span><h4>Dataset<a class="headerlink" href="#dataset" title="Permalink to this heading"></a></h4>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">...</span>
<span class="w">  </span><span class="nt">datasets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataset_1</span>
<span class="w">      </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Dataset</span><span class="nv"> </span><span class="s">1&quot;</span>
<span class="w">      </span><span class="nt">data</span><span class="p">:</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span>
<span class="w">        </span><span class="nt">h5ad</span><span class="p">:</span>
<span class="w">          </span><span class="nt">compute_embeddings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>Multiple datasets belong to a single <a class="reference internal" href="#project">project</a>, and each dataset can contain multiple data files.
Each dataset item is defined by the following keys:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dataset</span></code></p></td>
<td><p>a unique (within the project) name/id</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">data</span></code></p></td>
<td><p>a list of data files to be processed. See <a class="reference internal" href="#data">data</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">title</span></code></p></td>
<td><p><cite>optional</cite> title to show in the Vitessce visualization</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">description</span></code></p></td>
<td><p><cite>optional</cite> description to show in the Vitessce visualization</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">url</span></code></p></td>
<td><p><cite>optional</cite> url to prepend to each converted data file in the output Vitessce config file.
Vitessce will load files from this location.
This may be the final location to which files will be uploaded to and served
or a local location for testing.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">http://localhost:3000/</span></code></p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">layout</span></code></p></td>
<td><p><cite>optional</cite> predefined Vitessce layout to use.</p>
<p>Supersedes the global <code class="docutils literal notranslate"><span class="pre">layout</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">custom_layout</span></code></p></td>
<td><p><cite>optional</cite> string that defines a Vitessce layout.</p>
<p>Supersedes the global <code class="docutils literal notranslate"><span class="pre">custom_layout</span></code>. Supersedes <code class="docutils literal notranslate"><span class="pre">layout</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vitessce_options</span></code></p></td>
<td><p><cite>optional</cite> map of the contents of an input Anndata object
to be shown in the Vitessce visualization.</p>
<p>Supersedes the global <code class="docutils literal notranslate"><span class="pre">vitessce_options</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p></td>
<td><p><cite>optional</cite> map of arguments per data type to set as default for all files within the dataset.</p>
<p>Supersedes global and project <code class="docutils literal notranslate"><span class="pre">args</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<section id="data">
<span id="id5"></span><h5>Data<a class="headerlink" href="#data" title="Permalink to this heading"></a></h5>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">...</span>
<span class="w">  </span><span class="nt">data</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h5ad</span>
<span class="w">      </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/anndata.h5ad</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span>
<span class="w">        </span><span class="nt">compute_embeddings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">        </span><span class="nt">batch_processing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">raw_image</span>
<span class="w">      </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/sample_1.tif</span>
<span class="w">      </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sample_1</span>
</pre></div>
</div>
<p>Each data item defines an input file to be processed by the pipeline.
Multiple data files belong to a single <a class="reference internal" href="#dataset">dataset</a>.</p>
<p>A data item can define data files or images.</p>
<p>Data files are processed into AnnData objects and written to Zarr.
Image ilres are written to Zarr through <a class="reference external" href="https://github.com/glencoesoftware/bioformats2raw">bioformats2raw</a>.</p>
<p>For image files the supported image format is <code class="docutils literal notranslate"><span class="pre">tif</span></code>.
Images can be either raw images (microscopy images) or label images (containing segmentations).
Additionally, label images can be generated and processed if provided with the necessary data.
Label images can be generated for Visium data if provided with an <code class="docutils literal notranslate"><span class="pre">h5ad</span></code> file or
SpaceRanger output directory, and Xenium and MERSCOPE if provided with their
respective output directories.
Raw images can also be pre-processed, in the case of MERSCOPE data where the raw image channels
are stored in separate <code class="docutils literal notranslate"><span class="pre">tif</span></code> files the pipeline can concatenate them to then convert them.</p>
<p>Each data item must define at least
its <code class="docutils literal notranslate"><span class="pre">data_type</span></code> and <code class="docutils literal notranslate"><span class="pre">data_path</span></code>.</p>
<p>Supported values are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>data_type</p></th>
<th class="head"><p>data_path</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">h5ad</span></code></p></td>
<td><p>Path to the <code class="docutils literal notranslate"><span class="pre">h5ad</span></code> file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">spaceranger</span></code></p></td>
<td><p>Path to a SpaceRanger output directory</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xenium</span></code></p></td>
<td><p>Path to a Xenium output directory</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">merscope</span></code></p></td>
<td><p>Path to a MERSCOPE output directory</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">molecules</span></code></p></td>
<td><p>Path to a molecules <code class="docutils literal notranslate"><span class="pre">csv</span></code>/<code class="docutils literal notranslate"><span class="pre">tsv</span></code> file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">raw_image</span></code></p></td>
<td><p>Path to the raw <code class="docutils literal notranslate"><span class="pre">tif</span></code> image</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">label_image</span></code></p></td>
<td><p>Path to the raw <code class="docutils literal notranslate"><span class="pre">tif</span></code> image</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">raw_image_data</span></code></p></td>
<td><p>Path to a file or directory containing data from which to generate or pre-process a raw <code class="docutils literal notranslate"><span class="pre">tif</span></code> image.</p>
<p>Possible inputs depend on the supported technology from which the data is obtained,</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">merscope</span></code> requires a path to the output directory containing an <code class="docutils literal notranslate"><span class="pre">images</span></code> directory
where image channels are stored as <code class="docutils literal notranslate"><span class="pre">tif</span></code> files</p></li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">label_image_data</span></code></p></td>
<td><p>Path to a file or directory containing data from which to generate a label <code class="docutils literal notranslate"><span class="pre">tif</span></code> image.</p>
<p>Possible inputs depend on the supported technology from which the data is obtained,</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">visium</span></code> requires a path to an <code class="docutils literal notranslate"><span class="pre">h5ad</span></code> file or SpaceRanger output directory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xenium</span></code> requires a path to a Xenium output directory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">merscope</span></code> requires a path to a MERSCOPE output directory</p></li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p>Each data item is defined with the following keys:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">data_type</span></code></p></td>
<td><p>one of the supported types of files to be processed.</p>
<p>A type of data file: <code class="docutils literal notranslate"><span class="pre">h5ad</span></code>, <code class="docutils literal notranslate"><span class="pre">spaceranger</span></code>, <code class="docutils literal notranslate"><span class="pre">molecules</span></code>, <code class="docutils literal notranslate"><span class="pre">xenium</span></code>, <code class="docutils literal notranslate"><span class="pre">merscope</span></code>,</p>
<p>a type of image file <code class="docutils literal notranslate"><span class="pre">raw_image</span></code>, <code class="docutils literal notranslate"><span class="pre">label_image</span></code>,</p>
<p>or a type of image/data to generate/preprocess an image <code class="docutils literal notranslate"><span class="pre">raw_image_data</span></code>, <code class="docutils literal notranslate"><span class="pre">label_image_data</span></code></p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">data_path</span></code></p></td>
<td><p>path to the file or directory containing the data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prefix</span></code></p></td>
<td><p><cite>optional</cite> string to prefix the output filenames, along with the <code class="docutils literal notranslate"><span class="pre">project</span></code>
and <code class="docutils literal notranslate"><span class="pre">dataset</span></code> names, so the output filenames become <code class="docutils literal notranslate"><span class="pre">{project}-{dataset}-{prefix}-file.ext</span></code>.</p>
<p>Required if you have multiple input files of the same <code class="docutils literal notranslate"><span class="pre">data_type</span></code> within the same <code class="docutils literal notranslate"><span class="pre">project</span></code>
and <code class="docutils literal notranslate"><span class="pre">dataset</span></code>, as they would otherwise get
overwritten with the default output filename <code class="docutils literal notranslate"><span class="pre">{project}-{dataset}-file.ext</span></code>.</p>
<p>If a single input file generates multiple output files of the same type, a prefix will
automatically be added to each of them to avoid overwritting.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p></td>
<td><p><cite>optional</cite> map of arguments to use when processing the data file.</p>
<p><strong>Note</strong> that this must be a map of only arguments that correspond to the file’s <code class="docutils literal notranslate"><span class="pre">data_type</span></code>.</p>
<p>Supersedes global, project and dataset <code class="docutils literal notranslate"><span class="pre">args</span></code> for that <code class="docutils literal notranslate"><span class="pre">data_type</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p>In the case where <code class="docutils literal notranslate"><span class="pre">data_type</span></code> is <code class="docutils literal notranslate"><span class="pre">raw_image_data</span></code> or <code class="docutils literal notranslate"><span class="pre">label_image_data</span></code>
extra keys should be defined</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 29%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>data_type</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">file_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">raw_image_data</span></code></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">label_image_data</span></code></p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">visium</span></code>, <code class="docutils literal notranslate"><span class="pre">xenium</span></code> or <code class="docutils literal notranslate"><span class="pre">merscope</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ref_img</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">label_image_data</span></code></p></td>
<td><p>(required if <code class="docutils literal notranslate"><span class="pre">shape</span></code> is not set)
a reference <code class="docutils literal notranslate"><span class="pre">tif</span></code> image of the size of the desired label image.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">label_image_data</span></code></p></td>
<td><p>(required if <code class="docutils literal notranslate"><span class="pre">ref_img</span></code> is not set)
shape of the desired label image as <code class="docutils literal notranslate"><span class="pre">[int,</span> <span class="pre">int]</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="args">
<span id="id6"></span><h3>Args<a class="headerlink" href="#args" title="Permalink to this heading"></a></h3>
<p>Available <code class="docutils literal notranslate"><span class="pre">args</span></code> depend of the <code class="docutils literal notranslate"><span class="pre">data_type</span></code> of each <a class="reference internal" href="#data">data</a> item.</p>
<p>Image files data types <code class="docutils literal notranslate"><span class="pre">raw_image</span></code> and <code class="docutils literal notranslate"><span class="pre">label_image</span></code> take no <code class="docutils literal notranslate"><span class="pre">args</span></code>.</p>
<p>Possible values for each of the supported data types are as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">args</span><span class="p">:</span>
<span class="w">  </span><span class="nt">h5ad</span><span class="p">:</span>
<span class="w">    </span><span class="nt">compute_embeddings</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># set to `True` to compute PCA and UMAP if not already within the anndata object</span>
<span class="w">    </span><span class="nt">chunk_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w"> </span><span class="c1"># Zarr chunk size, defaults to 10</span>
<span class="w">    </span><span class="nt">var_index</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SYMBOL&quot;</span><span class="w"> </span><span class="c1"># `var` column from the anndata object to use as the gene names in the webapp. This reindexes the `var` matrix</span>
<span class="w">    </span><span class="nt">obs_subset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sample&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sample_id_1&quot;</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># optional `obs` column name an value(s) to subset the anndata object</span>
<span class="w">    </span><span class="nt">var_subset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;genome&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;GRCh38&quot;</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># optional `var` column name an value(s) to subset the anndata object</span>
<span class="w">    </span><span class="nt">batch_processing</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;False&quot;</span><span class="w"> </span><span class="c1"># set to `True` to process the file in batches to avoid loading the whole object into memory if it is too large</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span><span class="w"> </span><span class="c1"># batch size (number of columns to process at a time if matrix is dense/csc, number of rows if matrix is csr) if `batch_processing` is set to `True`</span>
<span class="w">    </span><span class="nt">consolidate_metadata</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># whether to consolidate output zarr metadata. Defaults to `True`</span>
<span class="w">  </span><span class="nt">spaceranger</span><span class="p">:</span>
<span class="w">    </span><span class="nt">save_h5ad</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># save the intermediate h5ad to the output directory. Defaults to `False`</span>
<span class="w">    </span><span class="nt">load_clusters</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># set to `False` to disable loading the clusters from the `analysis` directory</span>
<span class="w">    </span><span class="nt">load_embeddings</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># set to `False` to disable loading the embeddings (UMAP, tSNE and PCA) from the `analysis` directory</span>
<span class="w">    </span><span class="nt">load_raw</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;False&quot;</span><span class="w"> </span><span class="c1"># set to `True` to load the raw count file instead of the filtered count file</span>
<span class="w">  </span><span class="nt">xenium</span><span class="p">:</span>
<span class="w">    </span><span class="nt">save_h5ad</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># save the intermediate h5ad to the output directory. Defaults to `False`</span>
<span class="w">    </span><span class="nt">spatial_as_pixel</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># convert spatial coordinates to pixel coordinates. Defaults to `True`</span>
<span class="w">    </span><span class="nt">resolution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2125</span><span class="w"> </span><span class="c1"># pixel resolution used to convert the spatial coordinates. Defaults to 0.2125</span>
<span class="w">  </span><span class="nt">merscope</span><span class="p">:</span>
<span class="w">    </span><span class="nt">save_h5ad</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># save the intermediate h5ad to the output directory. Defaults to `False`</span>
<span class="w">    </span><span class="nt">filter_prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Blank-&quot;</span><span class="w"> </span><span class="c1"># prefix to filter out data from the cell by gene data. Defaults to `Blank-`</span>
<span class="w">  </span><span class="nt">molecules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">delimiter</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="c1"># the file delimiter. Defaults to `\t`</span>
<span class="w">    </span><span class="nt">has_header</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;True&quot;</span><span class="w"> </span><span class="c1"># set to `False` if csv/tsv file contains no header</span>
<span class="w">    </span><span class="nt">gene_col_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Name&quot;</span><span class="w"> </span><span class="c1"># name of the column for gene names. Defaults to `Name`.</span>
<span class="w">    </span><span class="nt">x_col_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;x_int&quot;</span><span class="w"> </span><span class="c1"># name of the column for `x` coordinates. Defaults to `x_int`.</span>
<span class="w">    </span><span class="nt">y_col_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;y_int&quot;</span><span class="w"> </span><span class="c1"># name of the column for `y` coordinates. Defaults to `y_int`.</span>
<span class="w">    </span><span class="nt">gene_col_idx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w"> </span><span class="c1"># column index of the column for gene names in case `has_header` is `False`.</span>
<span class="w">    </span><span class="nt">x_col_idx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"> </span><span class="c1"># column index of the column for `x` coordinates in case `has_header` is `False`.</span>
<span class="w">    </span><span class="nt">y_col_idx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"> </span><span class="c1"># column index of the column for `y` coordinates in case `has_header` is `False`.</span>
</pre></div>
</div>
<p>Note that in the case of <code class="docutils literal notranslate"><span class="pre">spaceranger</span></code>, <code class="docutils literal notranslate"><span class="pre">xenium</span></code> and <code class="docutils literal notranslate"><span class="pre">merscope</span></code> data, it initially gets converted
into an <code class="docutils literal notranslate"><span class="pre">h5ad</span></code> file and so when processed the <code class="docutils literal notranslate"><span class="pre">args</span></code> for <code class="docutils literal notranslate"><span class="pre">h5ad</span></code> also apply to them.
If specifying <code class="docutils literal notranslate"><span class="pre">args</span></code> directly to a <a class="reference internal" href="#data">data</a> item of these types
you can define both the <code class="docutils literal notranslate"><span class="pre">args</span></code> for that specific <code class="docutils literal notranslate"><span class="pre">data_type</span></code> and <code class="docutils literal notranslate"><span class="pre">h5ad</span></code>.</p>
<p>Example,</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">...</span>
<span class="w">  </span><span class="nt">data</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spaceranger</span>
<span class="w">      </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/project_1/dataset_1/spaceranger/output/</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span>
<span class="w">        </span><span class="nt">load_embeddings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"> </span><span class="c1"># for spaceranger</span>
<span class="w">        </span><span class="nt">compute_embeddings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"> </span><span class="c1"># for intermediate h5ad</span>
</pre></div>
</div>
<p>Image-data files data types (files from which to generate image files or images that require preprocessing)
<code class="docutils literal notranslate"><span class="pre">raw_image_data</span></code> and <code class="docutils literal notranslate"><span class="pre">label_image_data</span></code> take <code class="docutils literal notranslate"><span class="pre">args</span></code> at <a class="reference internal" href="#data">data</a> level (no global, <a class="reference internal" href="#project">project</a> or <a class="reference internal" href="#dataset">dataset</a> defaults)
depending on their <code class="docutils literal notranslate"><span class="pre">file_type</span></code>.
| Label images can be generated from data from <code class="docutils literal notranslate"><span class="pre">file_type</span></code>’s <code class="docutils literal notranslate"><span class="pre">visium</span></code>, <code class="docutils literal notranslate"><span class="pre">xenium</span></code> or <code class="docutils literal notranslate"><span class="pre">merscope</span></code>.
| Raw images can be preprocess from <code class="docutils literal notranslate"><span class="pre">file_type</span></code> <code class="docutils literal notranslate"><span class="pre">merscope</span></code>.</p>
<p>Image-data files of type <code class="docutils literal notranslate"><span class="pre">visium</span></code> can take the following <code class="docutils literal notranslate"><span class="pre">args</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span>
<span class="w">    </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">label_image_data</span>
<span class="w">    </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/visium/anndata.h5ad</span>
<span class="w">    </span><span class="nt">file_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">visium</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span>
<span class="w">      </span><span class="nt">obs_subset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sample&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sample_id_1&quot;</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># optional `obs` column name an value(s) to subset the anndata object</span>
<span class="w">      </span><span class="nt">sample_id</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sample_id_1&quot;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># optional key within anndata.uns[&quot;spatial&quot;]. Defaults to the first key.</span>
<span class="w">      </span><span class="nt">relative_size</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nspots&quot;</span><span class="w"> </span><span class="c1"># optional key within anndata.obs that contains multipliers for the spot size. Only useful for data that has been preprocessed to merge spots or modify spots&#39; sizes. Defaults to None.</span>
</pre></div>
</div>
<p>Image-data files of type <code class="docutils literal notranslate"><span class="pre">xenium</span></code> can take the following <code class="docutils literal notranslate"><span class="pre">args</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span>
<span class="w">    </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">label_image_data</span>
<span class="w">    </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/xenium/output/</span>
<span class="w">    </span><span class="nt">file_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xenium</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span>
<span class="w">      </span><span class="nt">resolution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2125</span><span class="w"> </span><span class="c1"># optional pixel resolution. Defaults to 0.2125</span>
</pre></div>
</div>
<p>Image-data files of type <code class="docutils literal notranslate"><span class="pre">merscope</span></code> can take the following <code class="docutils literal notranslate"><span class="pre">args</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span>
<span class="w">    </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">label_image_data</span><span class="w"> </span><span class="c1"># or raw_image_data</span>
<span class="w">    </span><span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/merscope/output/</span>
<span class="w">    </span><span class="nt">file_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">merscope</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span>
<span class="w">      </span><span class="nt">z_index</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># optional Z indices to process. Defaults to [0]</span>
</pre></div>
</div>
</section>
<section id="vitessce-options">
<span id="id7"></span><h3>Vitessce options<a class="headerlink" href="#vitessce-options" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">vitessce_options</span></code> map is used to write Vitessce config files.
One Vitessce config file is generated per <a class="reference internal" href="#dataset">dataset</a>.
Include relevant information from your data to be visualized.
All values are optional as they depend on them existing in your data.</p>
<p>Values that can be specified are as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vitessce_options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">    </span><span class="nt">xy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;obsm/spatial&quot;</span><span class="w"> </span><span class="c1"># where the Anndata object holds spatial coordinates</span>
<span class="w">  </span><span class="nt">mappings</span><span class="p">:</span><span class="w"> </span><span class="c1"># list of embeddings and the index of the dimensions to use in a scatterplot</span>
<span class="w">    </span><span class="nt">obsm/X_umap</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">obsm/spatial</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">factors</span><span class="p">:</span><span class="w"> </span><span class="c1"># list of useful metadata to show per cell when hovering over them in the visualization</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;obs/sample&quot;</span>
<span class="w">  </span><span class="nt">sets</span><span class="p">:</span><span class="w"> </span><span class="c1"># list of keys for grouping cells</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;obs/celltype&quot;</span><span class="w"> </span><span class="c1"># key with cell set labels</span>
<span class="w">      </span><span class="nt">score</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;obs/celltype_prob&quot;</span><span class="w"> </span><span class="c1"># key with cell set confidence/percentage scores (float values [0,1])</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;obs/sample&quot;</span><span class="w"> </span><span class="c1"># key with cell set labels, without associated scores</span>
<span class="w">  </span><span class="nt">matrix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X&quot;</span><span class="w"> </span><span class="c1"># expression matrix to use</span>
</pre></div>
</div>
<p><strong>Note</strong> that the pipeline does not check for the existence of these
metadata within the AnnData object. It is written directly to the Vitessce
config file. If they’re incorrectly specified then an error will occur when
Vitessce tries to load the data.</p>
<p>The output config file can be manually edited without re-running the pipeline
to fix or adapt the visualization to your needs.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="run.html" class="btn btn-neutral float-right" title="Running" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Haniffa Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>